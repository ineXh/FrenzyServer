function getMouse(a,b){MousePos.px=MousePos.x,MousePos.py=MousePos.y,void 0!=b?(MousePos.x=b.clientX,MousePos.y=b.clientY):void 0!=a.clientX?(MousePos.x=a.clientX,MousePos.y=a.clientY):(MousePos.x=a.data.global.x,MousePos.y=a.data.global.y),MousePos.x_pct=MousePos.x/width,MousePos.y_pct=MousePos.y/height,MousePos.stage_x=MousePos.x-stage.x,MousePos.stage_y=MousePos.y-stage.y,MousePos.stage_x_pct=MousePos.stage_x/stage_width,MousePos.stage_y_pct=MousePos.stage_y/stage_height}function onMouseStart(a){getMouse(a,void 0),MousePos.sx=MousePos.x,MousePos.sy=MousePos.y,drag(MousePos.x,MousePos.y)||(MousePos.touched=!0,gamestate==GameState.InPlay&&game.getTeam(myteam).path.startPath(MousePos.stage_x,MousePos.stage_y))}function onMouseMove(a){MousePos.touched&&(getMouse(a,void 0),gamestate==GameState.InPlay&&game.getTeam(myteam).path.updatePath(MousePos.stage_x,MousePos.stage_y))}function onMouseUp(a){MousePos.touched&&(getMouse(a,void 0),gamestate==GameState.InPlay&&(game.getTeam(myteam).path.endPath(MousePos.stage_x,MousePos.stage_y),gamemode==GameMode.MultiPlayer&&communication.socket.emit("path",game.getTeam(myteam).path.getLastTwoPoints())))}function onTouchStart(a){a.preventDefault(),getMouse(a,a.changedTouches[0]),MousePos.sx=MousePos.x,MousePos.sy=MousePos.y,MousePos.touched=!0,void 0!=game&&game.onTouchStart()}function onTouchMove(a){a.preventDefault(),MousePos.touched&&(getMouse(a,a.changedTouches[0]),gamestate==GameState.InPlay&&game.getTeam(myteam).path.updatePath(MousePos.stage_x,MousePos.stage_y))}function onTouchEnd(a){a.preventDefault(),MousePos.touched&&(getMouse(a,a.changedTouches[0]),MousePos.touched=!1,gamestate==GameState.InPlay&&(game.getTeam(myteam).path.endPath(MousePos.stage_x,MousePos.stage_y),gamemode==GameMode.MultiPlayer&&communication.socket.emit("path",game.getTeam(myteam).path.getLastTwoPoints())))}function addListeners(){renderer.view.addEventListener("mousedown",onMouseStart,!0),renderer.view.addEventListener("mouseup",onMouseUp,!0),renderer.view.addEventListener("mousemove",onMouseMove,!0),renderer.view.addEventListener("touchstart",onTouchStart,!0),renderer.view.addEventListener("touchend",onTouchEnd,!0),renderer.view.addEventListener("touchmove",onTouchMove,!0),renderer.view.addEventListener("backbutton",backButtonTap,!0)}function removeListeners(){renderer.view.removeEventListener("mousedown",onMouseStart,!0),renderer.view.removeEventListener("mouseup",onMouseUp,!0),renderer.view.removeEventListener("mousemove",onMouseMove,!0),renderer.view.removeEventListener("touchstart",onTouchStart,!0),renderer.view.removeEventListener("touchend",onTouchEnd,!0),renderer.view.removeEventListener("touchmove",onTouchMove,!0),renderer.view.removeEventListener("backbutton",backButtonTap,!0)}function drag(a,b){if($("#chatwindow").length<1)return!1;var c=$("#chatwindow").position().left,d=c+1.2*$("#chatwindow").width(),e=$("#chatwindow").position().top,f=e+1.2*$("#chatwindow").height();return!(a>d||c>a||b>f||e>b)}function backButtonTap(){}function stayinBorder(a){if(temp=a.clone(),temp.sub(new PVector(stage_width/2,stage_height/2)),temp.mag()>stage_width/2){var b=Math.atan2(temp.y,temp.x);a.x=stage_width/2+stage_width/2*Math.cos(b),a.y=stage_height/2+stage_height/2*Math.sin(b)}}function findDist(a,b){return PVector.dist(a,b)}function intersectCR(a,b,c,d,e,f,g){var h=new PVector(0,0);if(h.x=Math.abs(a-d),h.y=Math.abs(b-e),h.x>f/2+c)return!1;if(h.y>g/2+c)return!1;if(h.x<=f/2)return!0;if(h.y<=g/2)return!0;var i=(h.x-f/2)*(h.x-f/2)+(h.y-g/2)*(h.y-g/2);return c*c>=i}function withinDist(a,b,c){var d=PVector.dist(a,b);return c>d?!0:!1}function checkonScreen(a){var b=-stage.x+width,c=-stage.x,d=-stage.y+height,e=-stage.y;return a.x>b?!1:a.x<c?!1:a.y<e?!1:a.y>d?!1:!0}function RGBColor(a,b,c){return 65536*a+256*b+c}function getRndColor(){return 16777215*Math.random()}function getRngColor(a,b,c,d,e,f){var g=b*Math.random()|a,h=d*Math.random()|c,i=f*Math.random()|e;return"rgb("+g+","+h+","+i+")"}function getRandomArbitrary(a,b){return Math.random()*(b-a)+a}function getRandomInt(a,b){return Math.floor(Math.random()*(b-a))+a}function getBound(a){void 0==a.anchor&&(a.anchor={x:.5,y:.5}),a.right=a.x+Math.abs(a.width)*(1-a.anchor.x),a.left=a.x-Math.abs(a.width)*a.anchor.x,a.bot=a.y+Math.abs(a.height)*(1-a.anchor.y),a.top=a.y-Math.abs(a.height)*a.anchor.y}function isIntersecting(a,b){var c=b.x-Math.abs(b.width)*b.anchor.x>=a.x+Math.abs(a.width)*(1-a.anchor.x),d=b.x+Math.abs(b.width)*(1-b.anchor.x)<=a.x-Math.abs(a.width)*a.anchor.x,e=b.y-Math.abs(b.height)*b.anchor.y>=a.y+Math.abs(a.height)*(1-a.anchor.y),f=b.y+Math.abs(b.height)*(1-b.anchor.y)<=a.y-Math.abs(a.height)*a.anchor.y;return!(c||d||e||f)}function isTouching(a,b,c){return a>c.x&&a<c.x+c.width&&b>c.y&&b<c.y+c.height?!0:!1}function map(a,b,c,d,e){var f=(a-b)/(c-b);return f*(e-d)+d}function getRandomTop(){var a=new PVector(getRandomArbitrary(.1*-stage_width,1.1*stage_width),.1*-stage_height);return a}function getRandomLeft(){var a=new PVector(.1*-stage_width,getRandomArbitrary(.1*-stage_height,1.1*stage_height));return a}function getRandomRight(){var a=new PVector(1.1*stage_width,getRandomArbitrary(.1*-stage_height,1.1*stage_height));return a}function getRandomBot(){var a=new PVector(getRandomArbitrary(.1*-stage_width,1.1*stage_width),1.1*stage_height);return a}function getRandomBorder(){switch(getRandomInt(1,5)){case 1:return getRandomTop();case 2:return getRandomLeft();case 3:return getRandomRight();case 4:return getRandomBot();default:return getRandomTop()}}function lock(a){for(;a>2*PI;)a-=2*PI;for(;0>a;)a+=2*PI;return a}function lock_x(a){return 0>a?0:a>width?width:a}function lock_y(a){return 0>a?0:a>ground?ground:a}function getNormalPoint(a,b,c){var d=PVector.sub(a,b),e=PVector.sub(c,b);e.normalize(),e.mult(d.dot(e));var f=PVector.add(b,e);return f}function isBetween(a,b,c){var d=(a.y-b.y)*(c.x-b.x)-(a.x-b.x)*(c.y-b.y);if(Math.abs(d)>1)return!1;var e=(a.x-b.x)*(c.x-b.x)+(a.y-b.y)*(c.y-b.y),f=(c.x-b.x)*(c.x-b.x)+(c.y-b.y)*(c.y-b.y);return 0>e?!1:e>f?!1:!0}function crossproduct(a,b,c){return(a.y-b.y)*(c.x-b.x)-(a.x-b.x)*(c.y-b.y)}function applyForce(a){this.accel.add(a)}function simulateMouseEvent(a,b){if(!(a.touches.length>1)){a.preventDefault();var c=a.changedTouches[0],d=document.createEvent("MouseEvents");d.initMouseEvent(b,!0,!0,window,1,c.screenX,c.screenY,c.clientX,c.clientY,!1,!1,!1,!1,0,null),a.target.dispatchEvent(d)}}var MousePos={x:0,y:0,x_pct:0,y_pct:0,px:0,py:0,sx:0,sy:0,stage_x:0,stage_y:0,stage_x_pct:0,stage_y_pct:0,clicked:!1,touched:!1};