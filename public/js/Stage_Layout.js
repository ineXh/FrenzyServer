function Stage_Layout(){this.init()}var sprite,tile_index;Stage_Layout.prototype={init:function(){this.tiles=[]},load:function(){return this.load_s1()},place_stage:function(){stage.addChild(this.container),this.container.cacheAsBitmap=!0},load_s1:function(){var t=this;return new Promise(function(i,e){t.num_tiles_x=s1.width,t.end_x=t.num_tiles_x,t.num_tiles_y=s1.height,t.tilewidth=1.1*stage_width/t.num_tiles_x,t.tileheight=1.1*stage_height/t.num_tiles_y;for(var n,s=0;s<s1.tilesets.length;s++)n=PIXI.Texture.fromFrame(s1.tilesets[s].image),t.tiles.push({texture:n,id:s+1});t.data=s1.layers[0].data.slice(0),t.place(t.data),i()})},place:function(t){this.container=new PIXI.Container,this.container.sprites=[];for(var i=0;i<this.num_tiles_y;i++)for(var e=0;e<this.end_x;e++)this.fill_tile_sprite(t,i,e,this.container)},get_tile_index:function(t,i,e){if(e==this.num_tiles_x)var n=t[i*this.end_x+e];else var n=t[i*this.end_x+e];return n-=1},set_tile_index:function(t,i,e,n){e==this.num_tiles_x?t[i*this.end_x+e]=n:t[i*this.end_x+e]=n},fill_tile_sprite:function(t,i,e,n){var s=this.get_tile_index(t,i,e),a=new PIXI.Sprite(this.tiles[s].texture);return a.anchor.set(0,0),a.width=this.tilewidth,a.height=this.tileheight,a.x=(e-.5)*a.width*.95,a.y=i*a.height*.95,n.sprites.push(a),n.addChild(a),a},update:function(){},bound:function(t,i){var e=!1;return this.platformcontainers.forEach(function(n){return void 0!=n.surfaces?(n.surfaces.forEach(function(n){return n.bound_point(t,i)?e=!0:void 0}),e?!0:void 0):void 0}),e?!0:!1},interact:function(t){this.platformcontainers.forEach(function(i){i.surfaces.forEach(function(i){i.interact(t)})})},getRelevantTiles:function(t){t.x-Math.abs(t.width)*t.anchor.x}};