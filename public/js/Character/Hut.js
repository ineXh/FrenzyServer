function Hut(){this.create()}Hut.prototype=Object.create(Character.prototype),Hut.prototype.constructor=Character,Hut.prototype.create=function(){this.pos=new PVector(0,0,0),this.vel=new PVector(0,0,0),this.accel=new PVector(0,0,0),this.s_pos=new PVector(0,0,0),this.s_vel=new PVector(0,0,0),this.sprite=new PIXI.Sprite(hut_texture),this.r=.1*big_dim,this.scale=this.r/this.sprite.width,this.sprite.scale.set(this.scale),this.sprite.anchor.x=.5,this.sprite.anchor.y=.5,this.maxspeed=2*big_dim/1e3,this.override=!1,this.predict=new PVector(0,0),this.type=CharacterType.Hut,this.seekOpponent_count=0,this.seekOpponent_time=0,this.attack_count=0,this.attack_time=10,this.attacking=!1,this.Dead=!1,this.border=!0,this.maxhp=hut_max_hp,this.hp=this.maxhp,this.healthbar=new HealthBar(this),this.dmg=0,this.defense_stat=5,this.status=[StatusType.NotMovable],this.rect_container=new PIXI.Container,this.rect_sprite=new PIXI.Sprite(rect_texture),this.rect_sprite.scale.set(.2*width/this.rect_sprite.width),this.rect_sprite.anchor.x=.5,this.rect_sprite.anchor.y=.5,this.rect_sprite.position.x=0,this.rect_sprite.position.y=0,this.rect_scale=0,this.rect_container.addChild(this.rect_sprite),this.attack_sprite=new PIXI.Sprite(attack_upgrade_texture),this.attack_sprite.scale.set(this.rect_sprite.width/4/this.attack_sprite.width),this.attack_sprite.anchor.x=.5,this.attack_sprite.anchor.y=.5,this.attack_sprite.position.x=1.3*-this.attack_sprite.width,this.attack_sprite.position.y=0,this.rect_container.addChild(this.attack_sprite),this.attack_coin_sprite=new PIXI.Sprite(coin_texture),this.attack_coin_sprite.scale.set(this.attack_sprite.width/3/this.attack_coin_sprite.width),this.attack_coin_sprite.anchor.x=.5,this.attack_coin_sprite.anchor.y=.5,this.attack_coin_sprite.position.x=1.8*-this.attack_sprite.width,this.attack_coin_sprite.position.y=.5*this.attack_sprite.width,this.rect_container.addChild(this.attack_coin_sprite),this.attack_coin_text=new PIXI.extras.BitmapText("12",{font:"24px pixel-love",align:"left"}),this.attack_coin_text.position.x=1.6*-this.attack_sprite.width,this.attack_coin_text.position.y=.4*this.attack_sprite.width,this.attack_coin_text.tint=4278190199,this.attack_coin_text.scale.set(1),this.rect_container.addChild(this.attack_coin_text),this.defense_sprite=new PIXI.Sprite(defense_upgrade_texture),this.defense_sprite.scale.set(this.rect_sprite.width/4/this.defense_sprite.width),this.defense_sprite.anchor.x=.5,this.defense_sprite.anchor.y=.5,this.rect_container.addChild(this.defense_sprite),this.defense_coin_sprite=new PIXI.Sprite(coin_texture),this.defense_coin_sprite.scale.set(this.defense_sprite.width/3/this.defense_coin_sprite.width),this.defense_coin_sprite.anchor.x=.5,this.defense_coin_sprite.anchor.y=.5,this.defense_coin_sprite.position.x=.5*-this.defense_sprite.width,this.defense_coin_sprite.position.y=.5*this.defense_sprite.width,this.rect_container.addChild(this.defense_coin_sprite),this.defense_coin_text=new PIXI.extras.BitmapText("12",{font:"24px pixel-love",align:"left"}),this.defense_coin_text.position.x=.3*-this.defense_sprite.width,this.defense_coin_text.position.y=.4*this.defense_sprite.width,this.defense_coin_text.tint=4278190199,this.defense_coin_text.scale.set(1),this.rect_container.addChild(this.defense_coin_text),this.speed_sprite=new PIXI.Sprite(speed_upgrade_texture),this.speed_sprite.scale.set(this.rect_sprite.width/4/this.speed_sprite.width),this.speed_sprite.anchor.x=.5,this.speed_sprite.anchor.y=.5,this.speed_sprite.position.x=1.3*this.speed_sprite.width,this.rect_container.addChild(this.speed_sprite),this.speed_coin_sprite=new PIXI.Sprite(coin_texture),this.speed_coin_sprite.scale.set(this.speed_sprite.width/3/this.speed_coin_sprite.width),this.speed_coin_sprite.anchor.x=.5,this.speed_coin_sprite.anchor.y=.5,this.speed_coin_sprite.position.x=.8*this.speed_sprite.width,this.speed_coin_sprite.position.y=.5*this.speed_sprite.width,this.rect_container.addChild(this.speed_coin_sprite),this.speed_coin_text=new PIXI.extras.BitmapText("12",{font:"24px pixel-love",align:"left"}),this.speed_coin_text.position.x=1*this.speed_sprite.width,this.speed_coin_text.position.y=.4*this.speed_sprite.width,this.speed_coin_text.tint=4278190199,this.speed_coin_text.scale.set(1),this.rect_container.addChild(this.speed_coin_text),this.progress=new PIXI.Graphics},Hut.prototype.init=function(t){void 0!=t.id&&(this.id=t.id),this.team=t.team,void 0!=t.color&&(this.sprite.tint=t.color),this.pos.x=t.x,this.pos.y=t.y,stage.addChild(this.sprite),this.pos.z=4*this.sprite.height,this.dropped=!1,this.menu_popped=!1,this.menu_pop=!1,this.menu_unpop=!1,this.progress_angle=-PI/2,this.progressed=!1,this.progressing=!1,this.rect_container.addChild(this.progress),this.update_upgrade_cost(),this.team==myteam&&(this.sprite.interactive=!0,this.sprite.mousedown=this.touchstart.bind(this),this.sprite.touchstart=this.touchstart.bind(this),this.sprite.mouseup=this.touchend.bind(this),this.sprite.touchend=this.touchend.bind(this),this.rect_sprite.interactive=!0,this.rect_sprite.mousedown=this.rect_touchstart.bind(this),this.rect_sprite.touchstart=this.rect_touchstart.bind(this),this.attack_sprite.interactive=!0,this.attack_sprite.mousedown=this.attack_touchstart.bind(this),this.attack_sprite.touchstart=this.attack_touchstart.bind(this),this.defense_sprite.interactive=!0,this.defense_sprite.mousedown=this.defense_touchstart.bind(this),this.defense_sprite.touchstart=this.defense_touchstart.bind(this),this.speed_sprite.interactive=!0,this.speed_sprite.mousedown=this.speed_touchstart.bind(this),this.speed_sprite.touchstart=this.speed_touchstart.bind(this))},Hut.prototype.dropping=function(){this.dropped||(isNaN(this.accel.x),this.accel.add(new PVector(0,0,-this.sprite.height/20)),isNaN(this.accel.x),this.z_scale=1+this.pos.z/this.sprite.height,this.sprite.scale.set(this.scale*this.z_scale),this.vel=this.accel,this.vel.limit(this.maxspeed),this.pos.add(this.vel),isNaN(this.accel.x),this.accel.mult(0),isNaN(this.accel.x),this.pos.z<=0&&(this.pos.z=0,this.dropped=!0,stage.addChild(this.healthbar.bar)),isNaN(this.pos.x),this.sprite.position.x=this.pos.x,this.sprite.position.y=this.pos.y-this.pos.z)},Hut.prototype.popping=function(){this.menu_popped||(this.rect_scale+=.25,this.rect_container.scale.set(this.rect_scale),this.rect_scale>=1&&this.menu_pop&&(this.menu_pop=!1,this.menu_popped=!0,spritetouched_cancel_cb=this.unpop.bind(this)))},Hut.prototype.pop=function(){this.menu_popped=!1,this.menu_pop=!0,stage_front.addChild(this.rect_container),this.rect_container.x=this.pos.x-0*this.sprite.width/4,this.rect_container.y=this.pos.y-this.sprite.height,this.rect_scale=0,this.rect_container.scale.set(this.rect_scale)},Hut.prototype.unpopping=function(){this.menu_unpop&&(this.rect_scale-=.25,this.rect_container.scale.set(this.rect_scale),this.rect_scale<=0&&(this.menu_unpop=!1,this.menu_popped=!1,stage_front.removeChild(this.rect_container)))},Hut.prototype.unpop=function(){this.menu_unpop=!0},Hut.prototype.spread=function(){this.rect_container.addChild(this.attack_sprite)},Hut.prototype.clean=function(){stage.removeChild(this.sprite),stage.removeChild(this.healthbar.bar),stage_front.removeChild(this.rect_container)},Hut.prototype.update=function(t){this.dropping(),this.popping(),this.unpopping(),this.progress_update(),this.healthbar.update(),this.hp<=0&&(this.Dead=!0)},Hut.prototype.touchstart=function(t){this.dropped&&(this.menu_popped||(spritetouched=!0,this.pop()))},Hut.prototype.touchend=function(t){},Hut.prototype.progress_update=function(){this.progressed||(this.progress.clear(),this.progress.beginFill(16711680,.5),this.progress_angle+=2*PI/(100+25*this.progress_level),this.progress_angle>=3*PI/2&&(this.progress_angle=3*PI/2),this.progress.moveTo(0,0),this.progress.lineTo(0,-this.progress_r),this.progress.arc(0,0,this.progress_r,-PI/2,this.progress_angle,!1),this.progress.endFill(),this.progress_angle>=3*PI/2&&(this.progressing=!1,this.rect_container.removeChild(this.progress),this.progressed=!0,this.progressed_cb(),this.update_upgrade_cost(),this.progress_angle=-PI/2,spritetouched_cancel_cb=this.unpop.bind(this)))},Hut.prototype.rect_touchstart=function(t){spritetouched=!0},Hut.prototype.update_upgrade_cost=function(){this.attack_coin_text.text=""+game.teams[this.team].upgrade_cost(UpgradeType.Attack),this.defense_coin_text.text=""+game.teams[this.team].upgrade_cost(UpgradeType.Defense),this.speed_coin_text.text=""+game.teams[this.team].upgrade_cost(UpgradeType.Speed)},Hut.prototype.attack_touchstart=function(t){this.progressing||(spritetouched=!0,spritetouched_cancel_cb=spritetouched_cancel_cb=this.unpop.bind(this),game.teams[this.team].upgrade(UpgradeType.Attack)&&(spritetouched_cancel_cb=null,this.progress_angle=-PI/2,this.progress_r=this.attack_sprite.width/2,this.progress.x=this.attack_sprite.x,this.progress.y=this.attack_sprite.y,this.progress_level=game.teams[this.team].attack_upgrades,this.rect_container.addChild(this.progress),this.progressed=!1,this.progressing=!0,this.progressed_cb=game.teams[this.team].upgrade_finished.bind(game.teams[this.team],UpgradeType.Attack)))},Hut.prototype.defense_touchstart=function(t){this.progressing||(spritetouched=!0,spritetouched_cancel_cb=spritetouched_cancel_cb=this.unpop.bind(this),game.teams[this.team].upgrade(UpgradeType.Defense)&&(spritetouched_cancel_cb=null,this.progress_angle=-PI/2,this.progress_r=this.defense_sprite.width/2,this.progress.x=this.defense_sprite.x,this.progress.y=this.defense_sprite.y,this.progress_level=game.teams[this.team].defense_upgrades,this.rect_container.addChild(this.progress),this.progressed=!1,this.progressing=!0,this.progressed_cb=game.teams[this.team].upgrade_finished.bind(game.teams[this.team],UpgradeType.Defense)))},Hut.prototype.speed_touchstart=function(t){this.progressing||(spritetouched=!0,spritetouched_cancel_cb=spritetouched_cancel_cb=this.unpop.bind(this),game.teams[this.team].upgrade(UpgradeType.Speed)&&(spritetouched_cancel_cb=null,this.progress_angle=-PI/2,this.progress_r=this.speed_sprite.width/2,this.progress.x=this.speed_sprite.x,this.progress.y=this.speed_sprite.y,this.progress_level=game.teams[this.team].speed_upgrades,this.rect_container.addChild(this.progress),this.progressed=!1,this.progressing=!0,this.progressed_cb=game.teams[this.team].upgrade_finished.bind(game.teams[this.team],UpgradeType.Speed)))};