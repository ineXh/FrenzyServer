function ParticlesPool(){this.complete=!1,this.loadPool(),this.complete=!0}function Particles(){this.init(),this.pool=new ParticlesPool,this.createLookupTables()}function Particle(t,i,s){this.create(t,i,s)}function Text(t,i){this.input=t,this.type=i,this.sprite=new PIXI.extras.BitmapText("",{font:t.font,fill:t.fill,align:"center",stroke:"#FF0000",strokeThickness:3}),this.sprite.tint=RGBColor(255,0,0)}ParticlesPool.prototype={loadPool:function(){this.createText(),this.createIcon()},createIcon:function(){this.Icons=[]},borrowIcon:function(){return this.Icons.length>=1?this.Icons.shift():null},returnIcon:function(t){this.Icons.push(t)},createFlame:function(){this.flames=[],this.addFlameSprites(2)},addFlameSprites:function(t){for(var i=0;t>i;i++){var s=new PIXI.Sprite(flame_texture);s.tint=RGBColor(getRandomInt(230,255),getRandomInt(100,200),0),s.anchor.x=.5,s.anchor.y=.45;var e=new Particle(null,ParticleType.FLAME,s);this.flames.push(e)}},borrowFlame:function(){return this.flames.length>=1?this.flames.shift():null},returnFlame:function(t){this.flames.push(t)},createText:function(){this.texts=[],this.addText(8)},addText:function(t){console.log("addText");for(var i=0;t>i;i++){var s=new Text({font:"40px Ninja Naruto",fill:"black"},ParticleType.TEXT);this.texts.push(s)}},borrowText:function(){return this.texts.length>=1?this.texts.shift():null},returnText:function(t){this.texts.push(t)}},Particles.prototype={init:function(){this.particles=[],this.queue_particles=[]},getLength:function(){return this.particles.length},update:function(t){for(var i=this.particles.length-1;i>=0;i--){var s=this.particles[i];s.update(t),s.isDead()&&(null!=s.cb_dead&&s.cb_dead(),this.clean(s),this.particles.splice(i,1))}this.update_queue(t)},update_queue:function(t){if(!(this.queue_particles.length<1)){var i=this.queue_particles[0];i.isDead()?(this.queue_particles.length>=2&&(this.queue_particles[1].init(this.queue_particles[1].input),this.queue_particles[1].time_s=t.t,null!=this.queue_particles[1].cb&&this.queue_particles[1].cb()),null!=i.cb_dead&&i.cb_dead(),this.clean(i),this.queue_particles.splice(0,1)):i.update(t)}},spawn:function(t,i){var s=this.borrowParticle(i);null!=s&&(s.init(t),this.particles.push(s))},clean:function(t){t.clean(),this.returnParticle(t.type,t)},spawn_queue:function(t,i,s){var e=this.borrowParticle(i);null!=e&&(this.queue_particles.length<1?e.init(t):e.input=t,this.queue_particles.push(e))},createLookupTables:function(){this.borrowParticleLookup=[],this.borrowParticleLookup[ParticleType.FLAME]=this.pool.borrowFlame,this.borrowParticleLookup[ParticleType.TEXT]=this.pool.borrowText,this.borrowParticleLookup[ParticleType.ICON]=this.pool.borrowIcon,this.returnParticleLookup=[],this.returnParticleLookup[ParticleType.FLAME]=this.pool.returnFlame,this.returnParticleLookup[ParticleType.TEXT]=this.pool.returnText,this.returnParticleLookup[ParticleType.ICON]=this.pool.returnIcon},borrowParticle:function(t){return this.borrowParticleLookup[t].call(this.pool)},returnParticle:function(t,i){return void 0==this.returnParticleLookup[t]?void(i=null):this.returnParticleLookup[t].call(this.pool,i)}},Particle.prototype={create:function(t,i,s){this.type=i,this.sprite=s},init:function(t){this.input=t,this.sprite.anchor.x=.5,this.sprite.anchor.y=.5,t.track_ang&&(this.sprite.rotation=this.input.body.angle),t.play&&(this.sprite.animationSpeed=t.animationSpeed,this.sprite.play()),this.radius=Math.random()*width,this.oldRadius=this.radius,this.particle_init(t)},particle_init:function(t){this.sprite.x=t.x,this.sprite.y=t.y,this.pos=new PVector(t.x,t.y),null!=t.color&&(this.color=t.color),this.vel=new PVector(0,0),this.accel=new PVector(0,0),null!=t.ax&&(this.accel.x=t.ax),null!=t.ay&&(this.accel.y=t.ay),null!=t.x_end&&(this.x_start=t.x,t.x_end.length>=1?(this.index=0,this.x_end=t.x_end[0]):this.x_end=t.x_end),null!=t.y_end&&(this.y_start=t.y,t.y_end.length>=1?this.y_end=t.y_end[0]:this.y_end=t.y_end),void 0!=t.rs&&(this.rs=t.rs,this.r=this.rs,t.re.length>=1?this.re=t.re[0]:this.re=t.re,void 0==this.sprite||isNaN(this.r)||(this.sprite.width=this.rs),void 0==this.sprite||isNaN(this.r)||(this.sprite.height=this.rs)),null!=t.lifespan_s?this.lifespan_s=t.lifespan_s:this.lifespan_s=255,null!=t.lifespan_d?this.lifespan_d=t.lifespan_d:this.lifespan_d=5,this.lifespan=this.lifespan_s,this.pct=0,null!=t.duration?void 0!=t.duration.length?this.duration=t.duration[0]:this.duration=t.duration:this.duration=void 0,null==t.time&&(this.time_s=time.t),null!=t.cb?void 0!=t.cb.length?null!=t.cb[0]&&t.cb[0].call(this):t.cb.call(this):this.cb=null,null!=t.cb_dead?this.cb_dead=t.cb_dead:this.cb_dead=null,null!=t.does_not_die&&(this.does_not_die=t.does_not_die),void 0!=t.container?t.container.addChild(this.sprite):stage.addChild(this.sprite)},clean:function(){this.duration=null,this.cb_dead=null,this.lifespan_d=null,this.index=0,this.input.play&&this.sprite.stop(),stage.removeChild(this.sprite)},reset:function(){},update:function(t){this.vel.add(this.accel),this.pos.add(this.vel),this.accel.mult(0),this.sprite.rotation+=0,null!=this.duration?this.run_queue(t):(this.sprite.alpha=this.lifespan>0?this.lifespan/255:0,this.lifespan-=this.lifespan_d),void 0!=this.input.track_pos?(this.sprite.x=this.input.track_pos.x,this.sprite.y=this.input.track_pos.y):(this.sprite.x=this.pos.x,this.sprite.y=this.pos.y),1==this.input.track_ang&&(this.sprite.rotation=this.input.body.angle)},run_queue:function(t){this.pct=(t.t-this.time_s)/this.duration,void 0!=this.input.x_end&&void 0!=this.input.x_end.length&&this.index<this.input.x_end.length-1&&this.pct>1&&(this.pct-=1,void 0!=this.rs&&(this.rs=this.input.re[this.index]),void 0!=this.re&&(this.re=this.input.re[this.index+1]),this.x_start=this.input.x_end[this.index],this.y_start=this.input.y_end[this.index],this.x_end=this.input.x_end[this.index+1],this.y_end=this.input.y_end[this.index+1],void 0!=this.input.cb&&null!=this.input.cb[this.index+1]&&this.input.cb[this.index+1].call(this),this.duration=this.input.duration[this.index+1],this.time_s=t.t-this.duration*this.pct,this.index++),void 0!=this.input.x_end&&void 0!=this.input.x_end.length&&this.index==this.input.x_end.length-1&&this.pct>1&&(this.pct=1,this.duration=1),this.r=this.rs+(this.re-this.rs)*this.pct,void 0==this.sprite||isNaN(this.r)||(this.sprite.width=this.r),void 0==this.sprite||isNaN(this.r)||(this.sprite.height=this.r),null!=this.x_start&&(this.pos.x=this.x_start+(this.x_end-this.x_start)*this.pct),null!=this.y_start&&(this.pos.y=this.y_start+(this.y_end-this.y_start)*this.pct)},render:function(t){},isDead:function(){return this.does_not_die?!1:this.lifespan<=0||this.pct>=1}},Text.prototype=Object.create(Particle.prototype),Text.prototype.constructor=Particle,Text.prototype.init=function(t){this.sprite.text=t.text,stage.addChild(this.sprite),this.sprite.rotation=t.rotation,this.radius=Math.random()*width,this.oldRadius=this.radius,this.particle_init(t),null!=this.x_start&&(this.x_start=this.x_start-this.sprite.width/2),null!=this.x_end&&(this.x_end=this.x_end-this.sprite.width/2)};